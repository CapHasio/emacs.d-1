#+TITLE: Emacs Recipes
#+AUTHOR: Chunyang Xu
#+EMAIL: mail@xuchunyang.me
#+LANGUAGE: zh-CN

#+SUBTITLE: A cookbook for GNU Emacs
#+OPTIONS: toc:2

* 排序 (Sorting)
** 行内排序

*** 问题

把 "2 3 5 4 1" 修改成 "1 2 3 4 5"

*** 答案

1. 选中这 5 个数字
2. ~M-x sort-regexp-fields RET [0-9] RET \& RET~

*** 分析

"[0-9]" 指定排序的单元，这里指一个数字。"\&" 指定排序的单元中的键，这里指整个单元。

~sort-regexp-fields~ 使用字典排序 (Lexicographically or Alphabetical)，
由于上面只有一位数字，所有它也能用。

* 对齐 (Aligning)
* 搜索和替换 (Searching and Replacing)
** 交换 emacs 和 vim
*** 问题

同时把 emacs 替换成 vim，把 vim 替换成 emacs。

*** 答案

~M-x query-replace-regexp RET vim\|emacs RET \,(if (string= \0 "vim") "emacs" "vim") RET~

或

~M-x query-replace-regexp RET \(vim\)\|\(emacs\) RET \,(if \1 "emacs" "vim") RET~

*** 分析

替代一般是字符串，但也可以是一个一般 Lisp 表达式，用 ~\,~ 指定，这个表达式中可以包含一些预设的变量：

| \0  | 整个匹配（字符串）        |
| \&  | 同上                      |
| \N  | 匹配的第 N 个分组         |
| \#  | 已经匹配的次数（从 0 计） |
| \#& | 同 \&，但转换成了数字     |
| \#N | 同 \N，但转换成了数字     |
